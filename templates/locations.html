{% extends 'base.html' %} {% block content %}

<div class="row">
  <h4 class="center-align">Locations you have visited</h4>
  <div id="map" style="min-height:360px;"></div>
  <ul class="collection">
    {% for chapter in chapters %}
    <li class="collection-item avatar">
      <img src="{{chapter.main_photo}}" alt="" class="circle">
      <span class="title address" style="text-transform: capitalize;">{{chapter.city_name}}, {{chapter.country_name}}</span>
    </li>
    {% endfor %}
  </ul>
</div>
<script type="text/javascript">
  function initMap() {
    var geocoder = new google.maps.Geocoder();
    var latlng = new google.maps.LatLng(46.619261, -33.134766);
    var map = new google.maps.Map(document.getElementById("map"), {
      zoom: 1,
      center: latlng
    });
    geocodeAddress(geocoder, map);
  }
  var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  var labelIndex = 0;

  function geocodeAddress(geocoder, resultsMap) {
    var i;
    for (i = 0; i < document.getElementsByClassName('address').length; i++) {
      var address = document.getElementsByClassName('address')[i].textContent;
      geocoder.geocode({ 'address': address }, function(results, status) {
        if (status === 'OK') {
          resultsMap.setCenter(results[0].geometry.location);
          var marker = new google.maps.Marker({
            map: resultsMap,
            position: results[0].geometry.location,
            label: labels[labelIndex++ % labels.length],
          });
        }
        else {
          alert('Geocode was not successful for the following reason: ' + status);
        }
      });
    }
  }

</script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNFfFTnSu4IHn9fdoO7iD0xi3cy6kkDo8&callback=initMap">
</script>


{% endblock %}
